"use strict";(self.webpackChunkbetalectic_website=self.webpackChunkbetalectic_website||[]).push([["6645"],{7495:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return a},default:function(){return d},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return h}});var o=n(6642),r=n(5893),s=n(65);let i={slug:"second-story",title:"Second Story Post",authors:["shrey"],tags:["facebook","docusaurus"],image:"https://img.freepik.com/free-photo/colorful-design-with-spiral-design_188544-9588.jpg"},a=void 0,c={authorsImageUrls:[void 0]},h=[{value:"What is URL",id:"what-is-url",level:2},{value:"Use case",id:"use-case",level:2},{value:"Change of odds",id:"change-of-odds",level:2}];function l(e){let t={a:"a",h2:"h2",p:"p",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"My ideas for blog posts inevitably start to dry up after over two years at Apache APISIX. Hence, I did some triage on the APISIX repo. I stumbled upon this one question:"}),"\n",(0,r.jsx)(t.p,{children:"We have a requirement to use a plugin, where we need to route the traffic on percentage basis. I'll give an example for better understanding."}),"\n",(0,r.jsx)(t.h2,{id:"what-is-url",children:"What is URL"}),"\n",(0,r.jsxs)(t.p,{children:["We have an URL ",(0,r.jsx)(t.a,{href:"https://xyz.com/ca/fr/index.html",children:"https://xyz.com/ca/fr/index.html"})," where ca is country (canada) and fr is french language. Now the traffic needs to routed 10% to ",(0,r.jsx)(t.a,{href:"https://xyz.com/ca/en/index.html",children:"https://xyz.com/ca/en/index.html"})," and the remaining 90% to ",(0,r.jsx)(t.a,{href:"https://xyz.com/ca/fr/index.html",children:"https://xyz.com/ca/fr/index.html"}),". And whenever we're routing the traffic to ",(0,r.jsx)(t.a,{href:"https://xyz.com/ca/en/index.html",children:"https://xyz.com/ca/en/index.html"})," we need to set a cookie. So for next call, if the cookie is there, it should directly go to ",(0,r.jsx)(t.a,{href:"https://xyz.com/ca/en/index.html",children:"https://xyz.com/ca/en/index.html"})," else it should go via a 10:90 traffic split. What is the best possible way to achieve this ??"]}),"\n",(0,r.jsx)(t.p,{children:"-- help request: Setting cookie based on a condition"}),"\n",(0,r.jsx)(t.h2,{id:"use-case",children:"Use case"}),"\n",(0,r.jsx)(t.p,{children:"The use case is interesting, and I decided to tackle it."}),"\n",(0,r.jsx)(t.p,{children:"I'll rephrase the requirements first:"}),"\n",(0,r.jsx)(t.p,{children:"If no cookie is set, randomly forward the request to one of the upstreams\nIf a cookie has been set, forward the request to the correct upstream.\nFor easier testing:"}),"\n",(0,r.jsx)(t.p,{children:"Software engineering is a field that always changes to keep up with innovation and client needs. As developers, we have a difficult job staying up to date with these swift changes. It is imperative that we approach our information sources selectively because it is so easy for anyone to create a blog and publish anything."}),"\n",(0,r.jsx)(t.h2,{id:"change-of-odds",children:"Change of odds"}),"\n",(0,r.jsx)(t.p,{children:"I change the odds from 10:90 to 50:50\nI use the root instead of a host plus a path\nFinally, I assume that the upstream sets the cookie."}),"\n",(0,r.jsx)(t.p,{children:"Newcomers to Apache APISIX understand the matching algorithm very quickly: if a request matches a route's host, method, and path, forward it to the upstream set."}),"\n",(0,r.jsx)(t.p,{children:"Everything you need to know about CSS in blog and guide form. CSS Tricks is a top resource for developers who need to find out how anything in CSS works. I definitely use their site as a main resource for figuring out the best practices to meet the designs of designers on my products!"})]})}function d(e={}){let{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},65:function(e,t,n){n.d(t,{Z:function(){return a},a:function(){return i}});var o=n(7294);let r={},s=o.createContext(r);function i(e){let t=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:t},e.children)}},6642:function(e){e.exports=JSON.parse('{"permalink":"/pr-preview/pr-26/blog/second-story","source":"@site/blog/2024-12-03-second-blog-post.md","title":"Second Story Post","description":"My ideas for blog posts inevitably start to dry up after over two years at Apache APISIX. Hence, I did some triage on the APISIX repo. I stumbled upon this one question:","date":"2024-12-03T00:00:00.000Z","tags":[{"inline":true,"label":"facebook","permalink":"/pr-preview/pr-26/blog/tags/facebook"},{"inline":false,"label":"Docusaurus","permalink":"/pr-preview/pr-26/blog/tags/docusaurus","description":"Docusaurus tag description"}],"readingTime":1.835,"hasTruncateMarker":true,"authors":[{"name":"Shrey Dhyani","title":"Software Engineer & Avid Reader","page":{"permalink":"/pr-preview/pr-26/blog/authors/all-sebastien-lorber-articles"},"socials":{"x":"https://x.com/sebastienlorber","linkedin":"https://www.linkedin.com/in/sebastienlorber/"},"imageURL":"https://avatars.githubusercontent.com/u/107391802?s=96&v=4","key":"shrey"}],"frontMatter":{"slug":"second-story","title":"Second Story Post","authors":["shrey"],"tags":["facebook","docusaurus"],"image":"https://img.freepik.com/free-photo/colorful-design-with-spiral-design_188544-9588.jpg"},"unlisted":false,"prevItem":{"title":"Building a Dynamic Table Component: Backend Config Driven","permalink":"/pr-preview/pr-26/blog/dynamic-table-component"},"nextItem":{"title":"First Amazing Featured Post","permalink":"/pr-preview/pr-26/blog/2024/12/02/first-amazing-post copy"}}')}}]);